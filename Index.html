<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Finished Order Form</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>

body{
font-family:Arial;
background:#eee;
padding:20px;
}

#formBox{
width:900px;
background:white;
margin:auto;
border:2px solid black;
padding:15px;
}

table{
width:100%;
border-collapse:collapse;
}

td{
border:1px solid black;
padding:5px;
height:28px;
}

input{
width:100%;
border:none;
outline:none;
font-size:14px;
}

.bold{font-weight:bold;}
.center{text-align:center;}

button{
margin:10px;
padding:8px 15px;
}

</style>
</head>

<body>

<div style="text-align:center;">
<button onclick="downloadPDF()">Download PDF</button>
<button onclick="downloadJPG()">Download JPG</button>
</div>

<div id="formBox">

<table>

<tr>
<td colspan="6" class="center bold">FINISHED ORDER DETAILS</td>
</tr>

<tr>
<td class="bold">Client</td>
<td colspan="2"><input></td>

<td class="bold">Order No</td>
<td><input></td>

<td class="bold">Date</td>
<td><input type="date"></td>
</tr>

<tr>
<td class="bold">Invoice No</td>
<td><input></td>

<td class="bold">Month</td>
<td><input></td>

<td class="bold">D.Date</td>
<td><input type="date"></td>

<td class="bold">CAD No</td>
<td><input></td>
</tr>

<tr>
<td class="bold">Gross W</td>
<td><input></td>

<td class="bold">Net W</td>
<td><input></td>

<td colspan="4"></td>
</tr>

<tr>
<td colspan="8" class="center bold">DIAMOND / STONE</td>
</tr>

<tr class="bold center">
<td>Type</td>
<td>Weight</td>
<td>PCS</td>
<td colspan="3"></td>
</tr>

<tbody id="dia"></tbody>

<tr>
<td colspan="6" class="center">
<button onclick="add()">+ Add Diamond</button>
</td>
</tr>

<tr>
<td colspan="4" class="bold">Total PCS</td>
<td colspan="2"><input id="pcs" readonly></td>
</tr>

<tr>
<td class="bold">Gold Value</td>
<td colspan="2"><input></td>

<td class="bold">Making</td>
<td colspan="2"><input></td>
</tr>

<tr>
<td class="bold">CAD</td>
<td colspan="2"><input></td>

<td class="bold">Shipping</td>
<td colspan="2"><input></td>
</tr>

<tr>
<td class="bold">Report</td>
<td colspan="2"><input></td>

<td class="bold">Photo</td>
<td colspan="2"><input></td>
</tr>

<tr>
<td class="bold">Tracking ID</td>
<td colspan="3"><input></td>

<td class="bold">Date</td>
<td colspan="2"><input type="date"></td>
</tr>

</table>

</div>

<script>

function add(){

let t=document.getElementById("dia");

let r=document.createElement("tr");

r.innerHTML=`
<td><input></td>
<td><input type="number"></td>
<td><input type="number" oninput="total()"></td>
<td colspan="3"></td>
`;

t.appendChild(r);

}

function total(){

let sum=0;

document.querySelectorAll("#dia input[type='number']").forEach((e,i)=>{
if(i%2==1) sum+=Number(e.value||0);
});

document.getElementById("pcs").value=sum;

}

async function downloadPDF(){

const { jsPDF } = window.jspdf;

let box=document.getElementById("formBox");

let canvas=await html2canvas(box);

let img=canvas.toDataURL("image/png");

let pdf=new jsPDF("p","mm","a4");

let w=190;
let h=canvas.height*w/canvas.width;

pdf.addImage(img,"PNG",10,10,w,h);

pdf.save("order_form.pdf");

}

async function downloadJPG(){

let box=document.getElementById("formBox");

let canvas=await html2canvas(box);

let link=document.createElement("a");

link.download="order_form.jpg";

link.href=canvas.toDataURL("image/jpeg",1);

link.click();

}

</script>

</body>
</html>
